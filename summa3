import boto3

# Initialize the S3 client
s3 = boto3.client('s3')

# List all S3 buckets in your account
buckets = s3.list_buckets()['Buckets']

# Create a list to store subfolder names
subfolders = []

# Iterate through each bucket and list subfolders
for bucket in buckets:
    bucket_name = bucket['Name']
    
    # List objects in the bucket (including subfolders)
    objects = s3.list_objects_v2(Bucket=bucket_name)
    
    # List common prefixes (subfolders)
    for common_prefix in objects.get('CommonPrefixes', []):
        subfolder = common_prefix['Prefix']
        subfolders.append(f"Bucket: {bucket_name}, Subfolder: {subfolder}")

# Write the list of subfolder names to a file
with open('subfolders.txt', 'w') as file:
    for subfolder in subfolders:
        file.write(subfolder + '\n')

print(f"Subfolder names from all buckets have been written to subfolders.txt")
