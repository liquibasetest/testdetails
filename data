https://github.com/developer-advocacy-dremio/quick-guides-from-dremio/tree/main

# Check if the Iceberg table exists
if not spark._jsparkSession.catalog().tableExists(iceberg_output_path):
    # If the table does not exist, create it
    df.write.format("iceberg").mode("overwrite").option("uri", iceberg_output_path).saveAsTable("default.my_iceberg_table")
else:
    # If the table exists, append data to it
    df.write.format("iceberg").mode("append").option("uri", iceberg_output_path).saveAsTable("default.my_iceberg_table")

glueContext.write_dynamic_frame.from_catalog(
    frame=dynamic_frame,
    catalog_database=None,  # No need to specify a database
    catalog_table_name=None,  # No need to specify a table name
    connection_options={"write.location": iceberg_output_path},  # Specify the Iceberg output path
    format="iceberg",
    format_options={"write.operation": "overwrite"},
    transformation_ctx="datasink0"
)
