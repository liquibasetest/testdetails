https://github.com/developer-advocacy-dremio/quick-guides-from-dremio/tree/main

# Check if the Iceberg table exists
if not spark._jsparkSession.catalog().tableExists(iceberg_output_path):
    # If the table does not exist, create it
    df.write.format("iceberg").mode("overwrite").option("uri", iceberg_output_path).saveAsTable("default.my_iceberg_table")
else:
    # If the table exists, append data to it
    df.write.format("iceberg").mode("append").option("uri", iceberg_output_path).saveAsTable("default.my_iceberg_table")

# Read Parquet data into a DynamicFrame
dynamic_frame = glueContext.create_dynamic_frame.from_catalog(path=parquet_input_path, format="parquet")

# Write DynamicFrame to Iceberg table
glueContext.write_dynamic_frame.from_catalog(
    frame=dynamic_frame,
    database="default",
    table_name="my_iceberg_table",
    transformation_ctx="datasink0",
    format="iceberg",
    format_options={"write.operation": "overwrite"},
    catalog_versioning=False,  # Optional, set to True if you want to enable catalog versioning
    additional_options={"write.location": iceberg_output_path}  # Specify the Iceberg output path
)
