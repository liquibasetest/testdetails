https://github.com/developer-advocacy-dremio/quick-guides-from-dremio/tree/main

# Check if the Iceberg table exists
if not spark._jsparkSession.catalog().tableExists(iceberg_output_path):
    # If the table does not exist, create it
    df.write.format("iceberg").mode("overwrite").option("uri", iceberg_output_path).saveAsTable("default.my_iceberg_table")
else:
    # If the table exists, append data to it
    df.write.format("iceberg").mode("append").option("uri", iceberg_output_path).saveAsTable("default.my_iceberg_table")


df.write.format("iceberg").mode("append").option("path", iceberg_output_path).save()
