from fuzzywuzzy import fuzz
import pandas as pd

# Load the data from the first file
df1 = pd.read_csv('file1.csv')

# Load the data from the second file
df2 = pd.read_csv('file2.csv')

# Create an empty column in df2 for Classification
df2['Classification'] = ''

# Loop through the rows in df2 and match based on partial characters
for index2, row2 in df2.iterrows():
    logical_field_name2 = row2['LogicalFieldName']
    classification2 = ''

    for index1, row1 in df1.iterrows():
        logical_field_name1 = row1['LogicalFieldName']
        classification1 = row1['Classification']

        # Use fuzz.partial_ratio to determine similarity based on partial characters
        if fuzz.partial_ratio(logical_field_name2, logical_field_name1) >= 80:
            classification2 = classification1
            break

    # Update the Classification in df2
    df2.at[index2, 'Classification'] = classification2

# Save the updated df2 to a new file or overwrite the original
df2.to_csv('file2_with_classification.csv', index=False)
